<!DOCTYPE html>
<html>
    <head>
        
<meta charset="utf-8" />

    <title>Snackbot web UI</title>
    <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css">
    <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
    <script src="http://code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
    <link rel="stylesheet" href="style.css">

    <script language="javascript" type="text/javascript">
        
        var websocket;
        var wsUri = "ws://" + window.location.host + "/v1/biote/";
        var output;
        
         $(function() {
            $( "#forward" ).button().click(function( event ) {
                    var obj = {
                        eventName: "forward"
                    };
                    var jsonAsString = JSON.stringify(obj);
                    doSend(jsonAsString);
                });
            $( "#reverse" ).button().click(function( event ) {
                    var obj = {
                        eventName: "reverse"
                    };
                    var jsonAsString = JSON.stringify(obj);
                    doSend(jsonAsString);
                });
            $( "#left" ).button().click(function( event ) {
                    var obj = {
                        eventName: "left"
                    };
                    var jsonAsString = JSON.stringify(obj);
                    doSend(jsonAsString);
                });
            $( "#right" ).button().click(function( event ) {
                    var obj = {
                        eventName: "right"
                    };
                    var jsonAsString = JSON.stringify(obj);
                    doSend(jsonAsString);
                });
            });


  function onOpen(evt)
  {
    writeToScreen("CONNECTED");
  }

  function onClose(evt)
  {
    writeToScreen("DISCONNECTED");
  }

  function onMessage(evt)
  {
    writeToScreen('<span style="color: blue;">RESPONSE: ' + evt.data+'</span>');
  }

  function onError(evt)
  {
    writeToScreen('<span style="color: red;">ERROR:</span> ' + evt.data);
  }

  function doSend(message)
  {
    websocket.send(message);
    writeToScreen("SENT: " + message); 
  }

  function writeToScreen(message)
  {
    var pre = document.createElement("p");
    pre.style.wordWrap = "break-word";
    pre.innerHTML = message;
    output.appendChild(pre);
  }

  function init() {
    output = document.getElementById("output");

    websocket = new WebSocket(wsUri);
    websocket.onopen = function(evt) { onOpen(evt) };
    websocket.onclose = function(evt) { onClose(evt) };
    websocket.onmessage = function(evt) { onMessage(evt) };
    websocket.onerror = function(evt) { onError(evt) };
  }
  window.addEventListener("load", init, false);

</script>
    </head>
    
    <body>
        <h2>WebSocket Test</h2>

        <div id="output"></div>

        <p>
        <button id="forward">Forward</button>
        <button id="reverse">Reverse</button>
        <button id="left">Left</button>
        <button id="right">Right</button>
        
        </p>

    </body>
</html>
